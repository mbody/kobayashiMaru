#{extends 'main.html' /}
#{set title:'bilan d\'un entretien technique' /}

<div class="row">
    <div class="span12">
        <form class="well form-horizontal">


            <fieldset>
                <legend>&{'bilanInterview.title'}</legend>

                <div class="row">
                    <div class="span3">&{'candidate'}</div>
                    <div class="span3">
                        ${interview.candidateName} ${interview.candidateFirstName}
                    </div>
                </div>

                <div class="row">
                    <div class="span3">&{'bilanInterview.date'}</div>
                    <div class="span3">
                        ${interview.interviewDate?.format("dd/MM/yyyy HH:mm")}
                    </div>
                </div>

                <div class="row">
                    <div class="span3">&{'bilanInterview.examinateur'}</div>
                    <div class="span3">
                        ${interview.examiner?.lastname} ${interview.examiner?.firstname}
                    </div>
                </div>
                <div class="row">
                    <div class="span 2">
                        &{'bilanInterview.examinerComment'}
                    </div>
                    <div class="span8">
                        ${interview.examinerComment}
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>&{'bilanInterview.notes'}</legend>

                <div class="row">

                    #{list items:resultList, as:'noteAggregate' }

                        <div class="span3">Topic : ${noteAggregate.topic.label} </div>
                        <div class="span3">Difficulty : ${noteAggregate.difficulty} </div>
                        <div class="span3">Note moyenne : ${noteAggregate.average}</div>
                    #{/list}

                </div>
            </fieldset>

            #{list items:keysForMap, as: 'mapKey'}
                <fieldset>
                    <legend>${mapKey}</legend>

                        <div id="graph${mapKey}" style="margin-top: 20px; margin-left: 20px; width: 300px; height: 300px; position: relative; " class="jqplot-target">
                        </div>
                    <div class="row" id="detail${mapKey}">

                    </div>
                </fieldset>
            #{/list}

            
            
        </form>
    </div>
</div>
#{set 'moreScripts'}
    <script src="@{'/public/js/jquery.jqplot.js'}" type="text/javascript" charset="${_response_encoding}"></script>
    <script src="@{'/public/js/plugins/jqplot.barRenderer.js'}" type="text/javascript" charset="${_response_encoding}"></script>
    <script src="@{'/public/js/plugins/jqplot.categoryAxisRenderer.js'}" type="text/javascript" charset="${_response_encoding}"></script>
    <script>
        $(document).ready(function(){
                $.jqplot.config.enablePlugins = true;

                var ticks = ${ticks};

            #{list items:keysForMap, as: 'mapKey'}
                var serie${mapKey} = ${notesForTopic[mapKey]};
                plot${mapKey} = $.jqplot('graph${mapKey}', [serie${mapKey}], {
                    // Only animate if we're not using excanvas (not in IE 7 or IE 8)..
                    animate: !$.jqplot.use_excanvas,
                    seriesDefaults:{
                        renderer:$.jqplot.BarRenderer,
                        pointLabels: { show: true }
                    },
                    axes: {
                        xaxis: {
                            renderer: $.jqplot.CategoryAxisRenderer,
                            ticks: ticks
                        }
                    },
                    highlighter: { show: false }
                });
            #{/list}
            });
    </script>
#{/set}